% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/basis.R
\name{make_nystrom_basis}
\alias{make_nystrom_basis}
\title{Construct a Nyström Basis Using a Covariance Function and Landmark Points}
\usage{
make_nystrom_basis(
  cov_fn,
  landmarks,
  epsilon = 1e-06,
  k = NULL,
  crs = NULL,
  metadata = list(),
  domain = NULL,
  normalize = c("none", "l2"),
  normalization_points = 10000
)
}
\arguments{
\item{cov_fn}{A function taking two matrices \code{x1} and \code{x2} (each of shape \verb{[n, d]})
and returning a \verb{[nrow(x1), nrow(x2)]} covariance matrix. Must support vectorized input.}

\item{landmarks}{A numeric matrix \verb{[m, d]} of landmark locations.}

\item{epsilon}{Small scalar added to the diagonal of \code{K_UU} for numerical stability.}

\item{k}{Optional. Number of basis functions to retain (defaults to all available).}

\item{crs}{Optional coordinate reference system (passed to output \code{function_basis}).}

\item{metadata}{Optional list of metadata for downstream use.}

\item{domain}{Optional length-4 numeric vector \code{c(xmin, xmax, ymin, ymax)} for rescaling
both landmarks and evaluation coordinates to the unit square.}

\item{normalize}{Character string specifying normalization strategy.
Must be one of \code{"none"} (default) or \code{"l2"}.
\itemize{
\item \code{"none"}: return raw Nyström basis (scaled as-is).
\item \code{"l2"}: empirically normalize basis functions to have unit L2 norm over the unit square.
}}

\item{normalization_points}{Number of sample points used for computing L2 norms (only used if \code{normalize = "l2"}).}
}
\value{
A \code{function_basis} object with class \code{"nystrom"}, containing:
\itemize{
\item An \code{evaluate_fn} for computing the basis matrix at new locations,
\item The number of basis functions \code{k},
\item The original domain, landmarks, eigenvectors/values, and scaling metadata.
}
}
\description{
Builds a set of approximate eigenfunctions of a Gaussian process covariance operator
using the Nyström method. The basis functions are smooth and globally supported,
formed as linear combinations of kernel evaluations at landmark locations.
}
\details{
You may optionally normalize the basis functions using L2 normalization to improve
numerical stability and interpretability. This preserves the diagonal structure
of the prior covariance and avoids basis rotations.

If a \code{domain} is provided, landmark and evaluation coordinates are rescaled to
[0, 1]^2 to match the reference domain used when constructing the basis.
}
